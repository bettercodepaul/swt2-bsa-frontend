(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{NC86:function(e,t,a){"use strict";a.r(t),a.d(t,"LigatabelleModule",(function(){return C}));var i=a("ofXK"),l=a("3Pt+"),n=a("tyNb"),s=a("btWG"),o=a("th7h"),r=a("fXoL");let c=(()=>{class e{constructor(e){this.currentUserService=e}canActivate(){return this.currentUserService.hasAnyPermisson([])}}return e.\u0275fac=function(t){return new(t||e)(r.Ub(o.a))},e.\u0275prov=r.Hb({token:e,factory:e.\u0275fac}),e})();var d=a("mrSG"),h=a("wHSu"),b=a("PEb7");const g={moduleTranslationKey:"WETTKAEMPFE",pageTitleTranslationKey:"WETTKAEMPFE.WETTKAEMPFE.TITLE",navigationCardsConfig:{navigationCards:[]}},u={columns:[{translationKey:"WETTKAEMPFE.LIGATABELLE.TABELLENPLATZ",propertyName:"tabellenplatz",width:15,sortable:!1},{translationKey:"WETTKAEMPFE.LIGATABELLE.MANNSCHAFTNAME",propertyName:"mannschaft_name",width:70,sortable:!1},{translationKey:"WETTKAEMPFE.LIGATABELLE.MATCHPUNKTE",propertyName:"matchpunkte",width:15,sortable:!1},{translationKey:"WETTKAEMPFE.LIGATABELLE.SATZPUNKTE",propertyName:"satzpunkte",width:15,sortable:!1},{translationKey:"WETTKAEMPFE.LIGATABELLE.SATZPUNKTDIFFERENZ",propertyName:"satzpkt_differenz",width:15,sortable:!1}]};var E=a("nr0C"),p=a("v1Mt"),L=a("X628"),v=a("gQPg"),T=a("NJqk"),A=a("20cS"),f=a("S/GV"),I=a("a7Kz"),S=a("sNGV"),m=a("wNxx"),P=a("w90F"),F=a("ghtv"),y=a("3lZk"),D=a("yljE"),w=a("zLSN"),M=a("xOPY"),N=a("cWIM"),V=a("sYmb");const k=function(e){return[e]};let R=(()=>{class e extends b.CommonComponentDirective{constructor(e,t,a,i,l,n,s,o,r){super(),this.router=e,this.route=t,this.notificationService=a,this.veranstaltungsDataProvider=i,this.ligatabelleDataProvider=l,this.onOfflineService=n,this.currentUserService=s,this.einstellungenDataProvider=o,this.selectedLigaDataprovider=r,this.zuDenLigadetailsIcon=h.o,this.zuruecksetzenIcon=h.q,this.config=g,this.config_table=u,this.PLACEHOLDER_VAR="Zur Suche Liga-Bezeichnung eingeben...",this.ActionButtonColors=S.a,this.loading=!0,this.loadingLigatabelle=!0,this.multipleSelections=!0,this.hasVeranstaltung=!0,this.isDeselected=!1,this.istURLkorrekt=!1,this.sessionHandling=new A.a(this.currentUserService,this.onOfflineService)}ngOnInit(){0==this.isDeselected&&(this.loadTableData(),this.providedID=void 0,this.hasID=!1,this.notificationService.discardNotification(),this.route.params.subscribe(e=>{Object(L.c)(e.id)?(console.log("no params at ligatabelle"),this.router.navigate(["/ligatabelle/ligaid"])):(this.providedID=parseInt(e.id,10),this.hasID=!0,"ligaid"===e.id&&(this.hasID=!1),null!=this.selectedYearForVeranstaltung&&this.hasID&&this.loadVeranstaltungFromLigaIDAndSportYear(this.providedID,this.selectedYearForVeranstaltung))}))}loadVeranstaltungFromLigaIDAndSportYear(e,t){this.veranstaltungsDataProvider.findByLigaIdAndYear(e,t).then(e=>this.handleFindVeranstaltungSuccess(e)).catch(e=>this.handleFindVeranstaltungFailure(e))}handleFindVeranstaltungSuccess(e){this.hasVeranstaltung=!0,this.selectedItemId=e.payload.id,this.onSelectVeranstaltung([e.payload])}handleFindVeranstaltungFailure(e){this.hasVeranstaltung=!1,this.router.navigateByUrl("/ligatabelle")}onMouseOver(e){this.sessionHandling.checkSessionExpired()&&window.location.reload()}loadTableData(){return Object(d.a)(this,void 0,void 0,(function*(){this.loadedYears=[],this.availableYears=[],this.loadedVeranstaltungen=new Map,this.veranstaltungIdMap=new Map;let e=0,t=0,a=[];try{console.log(this.onOfflineService.isOffline());const i=yield this.veranstaltungsDataProvider.findAllSportyearDestinct();this.loadedYears=i.payload;for(const e of i.payload){const t=yield this.veranstaltungsDataProvider.findBySportjahrDestinct(e.sportjahr);for(const a of t.payload)this.veranstaltungIdMap.set(a.id,a),this.loadedVeranstaltungen.set(e.sportjahr,t.payload),this.availableYears.includes(e)||this.availableYears.push(e)}this.onOfflineService.isOffline()||(this.aktivesSportjahr=yield Object(I.a)(this.einstellungenDataProvider));for(const a of this.availableYears)a.sportjahr===this.aktivesSportjahr&&(e=t),t++;this.loading=!1,this.loadingLigatabelle=!1,this.selectedYearId=this.availableYears[e].id,this.availableYears.length>0&&(a.push(this.availableYears[e]),this.onSelectYear(a))}catch(i){this.loading=!1,this.loadingLigatabelle=!1,console.log(i)}}))}loadLigaTableRows(){this.loadingLigatabelle=!0,this.ligatabelleDataProvider.getLigatabelleVeranstaltung(this.selectedVeranstaltung.id).then(e=>this.handleLigatabelleSuccess(e)).catch(()=>this.handleLigatabelleFailure())}handleLigatabelleFailure(){console.log("failure"),this.rowsLigatabelle=[],this.loadingLigatabelle=!1}handleLigatabelleSuccess(e){console.log("success"),this.rowsLigatabelle=[],this.remainingLigatabelleRequests=e.payload.length,e.payload.length<=0||(this.rowsLigatabelle=Object(b.toTableRows)(e.payload)),this.loadingLigatabelle=!1}ligatabelleLinking(){this.router.navigateByUrl("/wettkaempfe/"+this.buttonForward)}onSelectYear(e){document.querySelector("#Button").style.display="block",this.veranstaltungenForYear=[],this.selectedYearForVeranstaltung=e[0].sportjahr,this.veranstaltungenForYear=this.loadedVeranstaltungen.get(e[0].sportjahr),this.selectedVeranstaltungId=this.veranstaltungenForYear[0].id,this.hasID&&this.loadVeranstaltungFromLigaIDAndSportYear(this.providedID,this.selectedYearForVeranstaltung)}onSelectVeranstaltung(e){this.selectedVeranstaltung=e[0],this.selectedVeranstaltungName=this.selectedVeranstaltung.name,this.buttonForward=this.selectedVeranstaltung.id,this.loadLigaTableRows(),this.router.navigate(["/ligatabelle/"+this.selectedVeranstaltung.ligaId])}deselect(){this.isDeselected=!0,console.log(this.isDeselected),this.router.navigateByUrl("/ligatabelle")}goToLigaDetails(){console.log("IDDD"+this.providedID),this.router.navigateByUrl("/home/"+this.providedID)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(n.c),r.Lb(n.a),r.Lb(v.c),r.Lb(E.a),r.Lb(p.a),r.Lb(T.i),r.Lb(T.a),r.Lb(f.a),r.Lb(m.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["bla-wettkaempfe"]],features:[r.wb],decls:43,vars:52,consts:[[3,"config"],[3,"mouseover"],["href","https://wiki.bsapp.de/doku.php?id=liga:ligatabelle","target","_blank"],[1,"subtitle"],[1,"layout-elements"],[1,"flexChild"],[1,"blackLink"],[2,"width","10%","margin-bottom","3%"],["selectionListHeight","3em",2,"width","10%","flex-grow","0","height","20px",3,"items","optionFieldSelector","loading","multipleSelections","selectedItemIds","onSelect"],["id","example",1,"table","table-hover","table-sm","table-responsive-sm","thead-light","table-striped",2,"width","80%"],["selectionListHeight","15em",2,"width","60%","flex-grow","0",3,"items","placeholderTranslationKey","optionFieldSelector","multipleSelections","selectedItemIds","onSelect"],[1,"row",2,"margin-left","5px"],[3,"config","rows","loading","onRowEntry"],["id","Button"],[3,"id","color","iconClass","onClick"],[1,"col-sm-9"],[1,"invalid-feedback"]],template:function(e,t){1&e&&(r.Qb(0,"bla-common-dialog",0),r.Qb(1,"div",1),r.Xb("mouseover",(function(e){return t.onMouseOver(e)})),r.Mb(2,"bla-hilfe-button",2),r.Qb(3,"p",3),r.Fc(4),r.cc(5,"translate"),r.Pb(),r.Qb(6,"div",4),r.Qb(7,"bla-row-layout"),r.Qb(8,"div",5),r.Qb(9,"h5"),r.Qb(10,"a",6),r.Fc(11),r.cc(12,"translate"),r.Pb(),r.Pb(),r.Qb(13,"table",7),r.Qb(14,"bla-selectionlist",8),r.Xb("onSelect",(function(e){return t.onSelectYear(e)})),r.Pb(),r.Pb(),r.Qb(15,"div"),r.Qb(16,"h5"),r.Qb(17,"a",6),r.Fc(18),r.cc(19,"translate"),r.Pb(),r.Pb(),r.Qb(20,"table",9),r.Qb(21,"bla-quicksearch-list",10),r.Xb("onSelect",(function(e){return t.onSelectVeranstaltung(e)})),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(22,"div"),r.Qb(23,"h5"),r.Qb(24,"a",6),r.Fc(25),r.cc(26,"translate"),r.Pb(),r.Pb(),r.Qb(27,"div",11),r.Qb(28,"bla-data-table",12),r.Xb("onRowEntry",(function(){return t.ligatabelleLinking()})),r.Pb(),r.Pb(),r.Pb(),r.Qb(29,"div",13),r.Qb(30,"bla-actionbutton",14),r.Xb("onClick",(function(){return t.ligatabelleLinking()})),r.Fc(31),r.cc(32,"translate"),r.Pb(),r.Qb(33,"bla-actionbutton",14),r.Xb("onClick",(function(){return t.goToLigaDetails()})),r.Fc(34),r.cc(35,"translate"),r.Pb(),r.Pb(),r.Qb(36,"div",15),r.Qb(37,"div",16),r.Fc(38),r.cc(39,"translate"),r.Pb(),r.Pb(),r.Pb(),r.Qb(40,"bla-actionbutton",14),r.Xb("onClick",(function(){return t.deselect()})),r.Fc(41),r.cc(42,"translate"),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.ic("config",t.config),r.zb(4),r.Gc(r.dc(5,32,"WETTKAEMPFE.LIGATABELLE.DESCRIPTION")),r.zb(7),r.Gc(r.dc(12,34,"MANAGEMENT.SPORTJAHR_OVERVIEW.TABLE.HEADERS.SPORTJAHR")),r.zb(3),r.ic("items",t.availableYears)("optionFieldSelector","sportjahr")("loading",t.loading)("multipleSelections",!t.multipleSelections)("selectedItemIds",r.nc(48,k,t.selectedYearId)),r.zb(4),r.Gc(r.dc(19,36,"WETTKAEMPFE.LIGATABELLE.HEADER.VERANSTALTUNG")),r.zb(3),r.ic("items",t.veranstaltungenForYear)("placeholderTranslationKey",t.PLACEHOLDER_VAR)("optionFieldSelector","ligaName")("multipleSelections",!t.multipleSelections)("selectedItemIds",r.nc(50,k,t.selectedItemId)),r.zb(4),r.Gc(r.dc(26,38,"WETTKAEMPFE.LIGATABELLE.TITEL")),r.zb(3),r.ic("config",t.config_table)("rows",t.rowsLigatabelle)("loading",t.loadingLigatabelle),r.zb(2),r.ic("id","regionSaveButton")("color",t.ActionButtonColors.SUCCESS)("iconClass","th-list"),r.zb(1),r.Ic(" ",r.dc(32,40,"WETTKAEMPFE.LIGATABELLE.LINKDESCRIPTION")," ",t.selectedVeranstaltungName," "),r.zb(2),r.ic("id","goToLigadetailsButton")("color",t.ActionButtonColors.PRIMARY)("iconClass",t.zuDenLigadetailsIcon),r.zb(1),r.Hc(" ",r.dc(35,42,"WETTKAEMPFE.LIGATABELLE.GOTO_LIGADETAILS")," "),r.zb(4),r.Hc(" ",r.dc(39,44,"MANAGEMENT.REGION_DETAIL.FORM.REGION_TYP.ERROR")," "),r.zb(2),r.ic("id","deselectLigaButton")("color",t.ActionButtonColors.SECONDARY)("iconClass",t.zuruecksetzenIcon),r.zb(1),r.Hc(" ",r.dc(42,46,"WETTKAEMPFE.LIGATABELLE.RESET_LIGASELECTION")," "))},directives:[P.a,F.a,y.a,D.a,w.a,M.a,N.a],pipes:[V.d],styles:[""]}),e})();const Y=[{path:"",component:R,canActivate:[c],pathMatch:"full"},{path:"/:id",component:R,canActivate:[c],pathMatch:"full"}];let C=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},providers:[c],imports:[[i.c,n.g.forChild(Y),s.SharedModule,l.k]]}),e})()}}]);