(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{wQCW:function(e,t,n){"use strict";n.r(t),n.d(t,"VereineModule",(function(){return N}));var i=n("ofXK"),a=n("3Pt+"),s=n("tyNb"),l=n("FpXt"),o=n("mrSG"),r=n("tY1a");const h={moduleTranslationKey:"VEREINE",pageTitleTranslationKey:"VEREINE.VEREINE.TITLE",navigationCardsConfig:{navigationCards:[]}},c={columns:[{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.VERANSTALTUNG",propertyName:"veranstaltung_name",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.WETTKAMPF",propertyName:"wettkampfTag",width:20},{translationKey:"TABLE.PLACE",propertyName:"wettkampfOrtsname",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.MANNSCHAFT",propertyName:"mannschaftsName",width:20}],actions:{actionTypes:[r.a.MAP],width:6}};var d=n("X628"),u=n("FlTZ"),p=n("PEb7"),g=n("ny2l"),f=n("sQ0O"),b=n("nr0C");class m{constructor(e,t,n,i){this.veranstaltung_name=e,this.wettkampfTag=t,this.wettkampfOrtsname=i,this.mannschaftsName=n,this.id=1,this.version=1}}var v=n("gQPg"),E=n("hEMT"),w=n("20cS"),y=n("NJqk"),V=n("fXoL"),T=n("U9hD"),S=n("ghtv"),I=n("hIfO"),D=n("zLSN"),P=n("xOPY"),R=n("sYmb");const O=function(e){return[e]};let k=(()=>{class e extends p.CommonComponentDirective{constructor(e,t,n,i,a,s,l,o,r){super(),this.router=e,this.route=t,this.notificationService=n,this.wettkampfDataProvider=i,this.veranstaltungsDataProvider=a,this.vereinDataProvider=s,this.mannschaftsDataProvider=l,this.currentUserService=o,this.onOfflineService=r,this.PLACEHOLDER_VAR="Bitte Verein eingeben...",this.config=h,this.config_table=c,this.multipleSelections=!0,this.loadingVereine=!0,this.loadingTable=!1,this.tableContent=[],this.sessionHandling=new w.a(this.currentUserService,this.onOfflineService)}ngOnInit(){console.log("Bin in Vereine"),this.currentVerein=null,this.providedID=null,this.hasID=!1,this.loading=!0,this.notificationService.discardNotification(),this.route.params.subscribe(e=>{Object(d.c)(e.id)||(this.hasID=!0,this.providedID=parseInt(e.id,10),console.log("This.providedID: "+this.providedID))}),this.loadVereine(),this.getAllVeranstaltungen(),this.getAllMannschaften()}onMouseOver(e){this.sessionHandling.checkSessionExpired()&&window.location.reload()}changeSelectedVerein(){this.selectedVereine=[],this.vereinDataProvider.findById(this.selectedVereinsId).then(e=>this.getVereinSuccess(e.payload)).catch(e=>console.log("Fehler im Verein laden"))}getVereinSuccess(e){this.currentVerein=e,this.selectedVereine.push(this.currentVerein)}onSelect(e){this.selectedDTOs=[],this.selectedDTOs=e,this.selectedDTOs&&this.selectedDTOs.length>0&&(this.selectedVereinsId=this.selectedDTOs[0].id),this.changeVerein()}changeVerein(){this.rows=[],this.tableContent=[],null!=this.selectedVereinsId&&this.loadTableRows()}getSelectedDTO(){if(Object(d.a)(this.selectedDTOs))return"";{const e=[];return this.selectedDTOs.forEach(t=>{e.push(t.name)}),e.join(", ")}}onView(e){}onEdit(e){}onDelete(e){}getSelectedColumn(e){this.typeOfTableColumn=e.propertyName}getAllVeranstaltungen(){this.veranstaltungsDataProvider.findAllGeplantLaufend().then(e=>{this.veranstaltungen=e.payload})}getAllMannschaften(){this.mannschaftsDataProvider.findAll().then(e=>{this.mannschaften=e.payload})}getSelectedRow(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=e.veranstaltung_name,n=e.mannschaftsName.replace(". Mannschaft","");this.linkPreperation(this.typeOfTableColumn,t,n)}))}linkPreperation(e,t,n){const i=this.veranstaltungen.find(e=>e.name===t);if("veranstaltung_name"===e)this.vereineLinking(i.id.toString(10));else if("mannschaftsName"===e){const e=this.mannschaften.find(e=>e.name===n);this.vereineLinking(i.id+"/"+e.id)}}vereineLinking(e){this.router.navigateByUrl("/wettkaempfe/"+e)}onMap(e){Object(E.a)(e)}loadVereine(){this.vereine=[],this.vereinDataProvider.findAll().then(e=>{this.vereine=e.payload.sort(),this.loadingVereine=!1,this.selectedVereinsId=this.hasID?this.providedID:e.payload[0].id,this.changeSelectedVerein(),this.onSelect(this.selectedVereine)}).catch(e=>{this.vereine=e.payload})}loadTableRows(){this.loadingTable=!0,this.mannschaftsDataProvider.findAllByVereinsId(this.selectedVereinsId).then(e=>this.handleFindMannschaftenSuccess(e)).catch(e=>this.handleFindMannschaftenFailure(e))}handleFindMannschaftenFailure(e){this.rows=[],this.loadingTable=!1}handleFindMannschaftenSuccess(e){let t;for(this.rows=[],this.remainingMannschaftsRequests=e.payload.length,e.payload.length<=0&&(this.loadingTable=!1),t=0;t<e.payload.length;t++){const n=e.payload[t].name+". Mannschaft";this.wettkampfDataProvider.findAllWettkaempfeByMannschaftsId(e.payload[t].id).then(e=>this.handleFindWettkaempfeSuccess(e,n)).catch(e=>this.handleFindWettkaempfeFailure(e))}}handleFindWettkaempfeFailure(e){this.rows=[],this.loadingTable=!1}handleFindWettkaempfeSuccess(e,t){console.log("success"),this.remainingRequests=e.payload.length,this.remainingMannschaftsRequests-=1,e.payload.length<=0&&(this.loadingTable=!1);for(const n of e.payload){const e=n.wettkampfTag+". Wettkampftag",i=n.wettkampfOrtsname;this.veranstaltungsDataProvider.findById(n.wettkampfVeranstaltungsId).then(n=>this.handleFindVeranstaltungSuccess(n,t,e,i)).catch(e=>this.handleFindVeranstaltungFailure(e))}if(0===e.payload.length){const e=new m("","",t,"");this.tableContent.push(e)}this.remainingMannschaftsRequests<=0&&(this.rows=Object(p.toTableRows)(this.tableContent))}handleFindVeranstaltungFailure(e){this.rows=[],this.loadingTable=!1}handleFindVeranstaltungSuccess(e,t,n,i){console.log("Content:"+e.payload.name+n+t+i);const a=new m(e.payload.name,n,t,i);this.tableContent.push(a),this.remainingRequests-=1,this.remainingRequests<=0&&(this.rows=Object(p.toTableRows)(this.tableContent),this.tableContent=[],this.loadingTable=!1)}}return e.\u0275fac=function(t){return new(t||e)(V.Lb(s.c),V.Lb(s.a),V.Lb(v.c),V.Lb(f.a),V.Lb(b.a),V.Lb(u.a),V.Lb(g.a),V.Lb(y.a),V.Lb(y.i))},e.\u0275cmp=V.Fb({type:e,selectors:[["bla-vereine"]],features:[V.wb],decls:16,vars:16,consts:[[3,"config"],[3,"mouseover"],["href","https://wiki.bsapp.de/doku.php?id=liga:vereine","target","_blank"],[1,"subtitle"],[1,"row"],[2,"display","inline"],["selectionListHeight","15em",2,"width","50%","flex-grow","0",3,"selectedItemIds","items","loading","multipleSelections","placeholderTranslationKey","optionFieldSelector","onSelect"],[3,"config","loading","rows","onColumnEntry","onMapEntry","onRowEntry"]],template:function(e,t){1&e&&(V.Qb(0,"bla-navigation-dialog",0),V.Qb(1,"div",1),V.Xb("mouseover",(function(e){return t.onMouseOver(e)})),V.Mb(2,"bla-hilfe-button",2),V.Qb(3,"p",3),V.Cc(4),V.ac(5,"translate"),V.Pb(),V.Qb(6,"div",4),V.Qb(7,"div"),V.Qb(8,"h2",5),V.Cc(9,"Gew\xe4hlter Verein: "),V.Pb(),V.Qb(10,"h3",5),V.Cc(11),V.Pb(),V.Pb(),V.Qb(12,"bla-col-layout"),V.Qb(13,"bla-quicksearch-list",6),V.Xb("onSelect",(function(e){return t.onSelect(e)})),V.Pb(),V.Pb(),V.Pb(),V.Qb(14,"div",4),V.Qb(15,"bla-data-table",7),V.Xb("onColumnEntry",(function(e){return t.getSelectedColumn(e)}))("onMapEntry",(function(e){return t.onMap(e)}))("onRowEntry",(function(e){return t.getSelectedRow(e)})),V.Pb(),V.Pb(),V.Pb(),V.Pb()),2&e&&(V.fc("config",t.config),V.zb(4),V.Dc(V.bc(5,12,"VEREINE.VEREINE.DESCRIPTION")),V.zb(7),V.Dc(t.getSelectedDTO()),V.zb(2),V.fc("selectedItemIds",V.kc(14,O,t.selectedVereinsId))("items",t.vereine)("loading",t.loadingVereine)("multipleSelections",!t.multipleSelections)("placeholderTranslationKey",t.PLACEHOLDER_VAR)("optionFieldSelector","name"),V.zb(2),V.fc("config",t.config_table)("loading",t.loadingTable)("rows",t.rows))},directives:[T.a,S.a,I.a,D.a,P.a],pipes:[R.d],styles:[".row[_ngcontent-%COMP%]{margin:20px;display:flex;flex-direction:column}"]}),e})();const C=[{path:"",pathMatch:"full",component:k},{path:"/:id",pathMatch:"full",component:k}];let N=(()=>{class e{}return e.\u0275mod=V.Jb({type:e}),e.\u0275inj=V.Ib({factory:function(t){return new(t||e)},imports:[[i.c,s.g.forChild(C),l.a,a.k]]}),e})()}}]);