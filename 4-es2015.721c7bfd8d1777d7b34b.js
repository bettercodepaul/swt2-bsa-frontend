(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{wQCW:function(e,t,n){"use strict";n.r(t),n.d(t,"VereineModule",(function(){return N}));var i=n("ofXK"),a=n("3Pt+"),s=n("tyNb"),l=n("FpXt"),o=n("mrSG"),r=n("tY1a");const h={moduleTranslationKey:"VEREINE",pageTitleTranslationKey:"VEREINE.VEREINE.TITLE",navigationCardsConfig:{navigationCards:[]}},c={columns:[{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.VERANSTALTUNG",propertyName:"veranstaltung_name",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.WETTKAMPF",propertyName:"wettkampfTag",width:20},{translationKey:"TABLE.PLACE",propertyName:"wettkampfOrtsname",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.MANNSCHAFT",propertyName:"mannschaftsName",width:20}],actions:{actionTypes:[r.a.MAP],width:6}};var d=n("X628"),u=n("FlTZ"),g=n("PEb7"),p=n("ny2l"),f=n("sQ0O"),m=n("nr0C");class b{constructor(e,t,n,i){this.veranstaltung_name=e,this.wettkampfTag=t,this.wettkampfOrtsname=i,this.mannschaftsName=n,this.id=1,this.version=1}}var E=n("gQPg"),v=n("hEMT"),y=n("fXoL"),w=n("U9hD"),V=n("hIfO"),T=n("zLSN"),D=n("xOPY");const S=function(e){return[e]};let I=(()=>{class e extends g.CommonComponentDirective{constructor(e,t,n,i,a,s,l){super(),this.router=e,this.route=t,this.notificationService=n,this.wettkampfDataProvider=i,this.veranstaltungsDataProvider=a,this.vereinDataProvider=s,this.mannschaftsDataProvider=l,this.PLACEHOLDER_VAR="Bitte Verein eingeben...",this.config=h,this.config_table=c,this.multipleSelections=!0,this.loadingVereine=!0,this.loadingTable=!1,this.tableContent=[]}ngOnInit(){console.log("Bin in Vereine"),this.currentVerein=null,this.providedID=null,this.hasID=!1,this.loading=!0,this.notificationService.discardNotification(),this.route.params.subscribe(e=>{Object(d.c)(e.id)||(this.hasID=!0,this.providedID=parseInt(e.id,10),console.log("This.providedID: "+this.providedID))}),this.loadVereine(),this.getAllVeranstaltungen(),this.getAllMannschaften()}changeSelectedVerein(){this.selectedVereine=[],this.vereinDataProvider.findById(this.selectedVereinsId).then(e=>this.getVereinSuccess(e.payload)).catch(e=>console.log("Fehler im Verein laden"))}getVereinSuccess(e){this.currentVerein=e,this.selectedVereine.push(this.currentVerein)}onSelect(e){this.selectedDTOs=[],this.selectedDTOs=e,this.selectedDTOs&&this.selectedDTOs.length>0&&(this.selectedVereinsId=this.selectedDTOs[0].id),this.changeVerein()}changeVerein(){this.rows=[],this.tableContent=[],null!=this.selectedVereinsId&&this.loadTableRows()}getSelectedDTO(){if(Object(d.a)(this.selectedDTOs))return"";{const e=[];return this.selectedDTOs.forEach(t=>{e.push(t.name)}),e.join(", ")}}onView(e){}onEdit(e){}onDelete(e){}getSelectedColumn(e){this.typeOfTableColumn=e.propertyName}getAllVeranstaltungen(){this.veranstaltungsDataProvider.findAll().then(e=>{this.veranstaltungen=e.payload})}getAllMannschaften(){this.mannschaftsDataProvider.findAll().then(e=>{this.mannschaften=e.payload})}getSelectedRow(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=e.veranstaltung_name,n=e.mannschaftsName.replace(". Mannschaft","");this.linkPreperation(this.typeOfTableColumn,t,n)}))}linkPreperation(e,t,n){const i=this.veranstaltungen.find(e=>e.name===t);if("veranstaltung_name"===e)this.vereineLinking(i.id.toString(10));else if("mannschaftsName"===e){const e=this.mannschaften.find(e=>e.name===n);this.vereineLinking(i.id+"/"+e.id)}}vereineLinking(e){this.router.navigateByUrl("/wettkaempfe/"+e)}onMap(e){Object(v.a)(e)}loadVereine(){this.vereine=[],this.vereinDataProvider.findAll().then(e=>{this.vereine=e.payload.sort(),this.loadingVereine=!1,this.selectedVereinsId=this.hasID?this.providedID:e.payload[0].id,this.changeSelectedVerein(),this.onSelect(this.selectedVereine)}).catch(e=>{this.vereine=e.payload})}loadTableRows(){this.loadingTable=!0,this.mannschaftsDataProvider.findAllByVereinsId(this.selectedVereinsId).then(e=>this.handleFindMannschaftenSuccess(e)).catch(e=>this.handleFindMannschaftenFailure(e))}handleFindMannschaftenFailure(e){this.rows=[],this.loadingTable=!1}handleFindMannschaftenSuccess(e){let t;for(this.rows=[],this.remainingMannschaftsRequests=e.payload.length,e.payload.length<=0&&(this.loadingTable=!1),t=0;t<e.payload.length;t++){const n=e.payload[t].name+". Mannschaft";this.wettkampfDataProvider.findAllWettkaempfeByMannschaftsId(e.payload[t].id).then(e=>this.handleFindWettkaempfeSuccess(e,n)).catch(e=>this.handleFindWettkaempfeFailure(e))}}handleFindWettkaempfeFailure(e){this.rows=[],this.loadingTable=!1}handleFindWettkaempfeSuccess(e,t){console.log("success"),this.remainingRequests=e.payload.length,this.remainingMannschaftsRequests-=1,e.payload.length<=0&&(this.loadingTable=!1);for(const n of e.payload){const e=n.wettkampfTag+". Wettkampftag",i=n.wettkampfOrtsname;this.veranstaltungsDataProvider.findById(n.wettkampfVeranstaltungsId).then(n=>this.handleFindVeranstaltungSuccess(n,t,e,i)).catch(e=>this.handleFindVeranstaltungFailure(e))}if(0===e.payload.length){const e=new b("","",t,"");this.tableContent.push(e)}this.remainingMannschaftsRequests<=0&&(this.rows=Object(g.toTableRows)(this.tableContent))}handleFindVeranstaltungFailure(e){this.rows=[],this.loadingTable=!1}handleFindVeranstaltungSuccess(e,t,n,i){console.log("Content:"+e.payload.name+n+t+i);const a=new b(e.payload.name,n,t,i);this.tableContent.push(a),this.remainingRequests-=1,this.remainingRequests<=0&&(this.rows=Object(g.toTableRows)(this.tableContent),this.tableContent=[],this.loadingTable=!1)}}return e.\u0275fac=function(t){return new(t||e)(y.Jb(s.c),y.Jb(s.a),y.Jb(E.c),y.Jb(f.a),y.Jb(m.a),y.Jb(u.a),y.Jb(p.a))},e.\u0275cmp=y.Db({type:e,selectors:[["bla-vereine"]],features:[y.ub],decls:8,vars:13,consts:[[3,"config"],[1,"row"],["selectionListHeight","15em",2,"width","50%","flex-grow","0",3,"selectedItemIds","items","loading","multipleSelections","placeholderTranslationKey","optionFieldSelector","onSelect"],[3,"config","loading","rows","onColumnEntry","onRowEntry","onMapEntry"]],template:function(e,t){1&e&&(y.Ob(0,"bla-navigation-dialog",0),y.Ob(1,"div",1),y.Ob(2,"bla-col-layout"),y.Ob(3,"h2"),y.wc(4),y.Nb(),y.Ob(5,"bla-quicksearch-list",2),y.Vb("onSelect",(function(e){return t.onSelect(e)})),y.Nb(),y.Nb(),y.Nb(),y.Ob(6,"div",1),y.Ob(7,"bla-data-table",3),y.Vb("onColumnEntry",(function(e){return t.getSelectedColumn(e)}))("onRowEntry",(function(e){return t.getSelectedRow(e)}))("onMapEntry",(function(e){return t.onMap(e)})),y.Nb(),y.Nb(),y.Nb()),2&e&&(y.dc("config",t.config),y.xb(4),y.yc("Vereinsauswahl: ",t.getSelectedDTO(),""),y.xb(1),y.dc("selectedItemIds",y.ic(11,S,t.selectedVereinsId))("items",t.vereine)("loading",t.loadingVereine)("multipleSelections",!t.multipleSelections)("placeholderTranslationKey",t.PLACEHOLDER_VAR)("optionFieldSelector","name"),y.xb(2),y.dc("config",t.config_table)("loading",t.loadingTable)("rows",t.rows))},directives:[w.a,V.a,T.a,D.a],styles:[".row[_ngcontent-%COMP%]{margin:20px;display:flex;flex-direction:column}"]}),e})();const O=[{path:"",pathMatch:"full",component:I},{path:"/:id",pathMatch:"full",component:I}];let N=(()=>{class e{}return e.\u0275mod=y.Hb({type:e}),e.\u0275inj=y.Gb({factory:function(t){return new(t||e)},imports:[[i.c,s.g.forChild(O),l.a,a.k]]}),e})()}}]);