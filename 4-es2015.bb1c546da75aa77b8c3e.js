(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{wQCW:function(e,t,n){"use strict";n.r(t),n.d(t,"VereineModule",(function(){return k}));var i=n("ofXK"),a=n("3Pt+"),s=n("tyNb"),l=n("FpXt"),o=n("mrSG"),r=n("tY1a");const h={moduleTranslationKey:"VEREINE",pageTitleTranslationKey:"VEREINE.VEREINE.TITLE",navigationCardsConfig:{navigationCards:[]}},c={columns:[{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.VERANSTALTUNG",propertyName:"veranstaltung_name",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.WETTKAMPF",propertyName:"wettkampfTag",width:20},{translationKey:"TABLE.PLACE",propertyName:"wettkampfOrtsname",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.MANNSCHAFT",propertyName:"mannschaftsName",width:20}],actions:{actionTypes:[r.a.MAP],width:6}};var d=n("X628"),p=n("FlTZ"),u=n("PEb7"),g=n("ny2l"),f=n("sQ0O"),b=n("nr0C");class m{constructor(e,t,n,i){this.veranstaltung_name=e,this.wettkampfTag=t,this.wettkampfOrtsname=i,this.mannschaftsName=n,this.id=1,this.version=1}}var E=n("gQPg"),v=n("hEMT"),y=n("fXoL"),w=n("U9hD"),V=n("ghtv"),T=n("hIfO"),I=n("zLSN"),S=n("xOPY"),D=n("sYmb");const P=function(e){return[e]};let R=(()=>{class e extends u.CommonComponentDirective{constructor(e,t,n,i,a,s,l){super(),this.router=e,this.route=t,this.notificationService=n,this.wettkampfDataProvider=i,this.veranstaltungsDataProvider=a,this.vereinDataProvider=s,this.mannschaftsDataProvider=l,this.PLACEHOLDER_VAR="Bitte Verein eingeben...",this.config=h,this.config_table=c,this.multipleSelections=!0,this.loadingVereine=!0,this.loadingTable=!1,this.tableContent=[]}ngOnInit(){console.log("Bin in Vereine"),this.currentVerein=null,this.providedID=null,this.hasID=!1,this.loading=!0,this.notificationService.discardNotification(),this.route.params.subscribe(e=>{Object(d.c)(e.id)||(this.hasID=!0,this.providedID=parseInt(e.id,10),console.log("This.providedID: "+this.providedID))}),this.loadVereine(),this.getAllVeranstaltungen(),this.getAllMannschaften()}changeSelectedVerein(){this.selectedVereine=[],this.vereinDataProvider.findById(this.selectedVereinsId).then(e=>this.getVereinSuccess(e.payload)).catch(e=>console.log("Fehler im Verein laden"))}getVereinSuccess(e){this.currentVerein=e,this.selectedVereine.push(this.currentVerein)}onSelect(e){this.selectedDTOs=[],this.selectedDTOs=e,this.selectedDTOs&&this.selectedDTOs.length>0&&(this.selectedVereinsId=this.selectedDTOs[0].id),this.changeVerein()}changeVerein(){this.rows=[],this.tableContent=[],null!=this.selectedVereinsId&&this.loadTableRows()}getSelectedDTO(){if(Object(d.a)(this.selectedDTOs))return"";{const e=[];return this.selectedDTOs.forEach(t=>{e.push(t.name)}),e.join(", ")}}onView(e){}onEdit(e){}onDelete(e){}getSelectedColumn(e){this.typeOfTableColumn=e.propertyName}getAllVeranstaltungen(){this.veranstaltungsDataProvider.findAll().then(e=>{this.veranstaltungen=e.payload})}getAllMannschaften(){this.mannschaftsDataProvider.findAll().then(e=>{this.mannschaften=e.payload})}getSelectedRow(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=e.veranstaltung_name,n=e.mannschaftsName.replace(". Mannschaft","");this.linkPreperation(this.typeOfTableColumn,t,n)}))}linkPreperation(e,t,n){const i=this.veranstaltungen.find(e=>e.name===t);if("veranstaltung_name"===e)this.vereineLinking(i.id.toString(10));else if("mannschaftsName"===e){const e=this.mannschaften.find(e=>e.name===n);this.vereineLinking(i.id+"/"+e.id)}}vereineLinking(e){this.router.navigateByUrl("/wettkaempfe/"+e)}onMap(e){Object(v.a)(e)}loadVereine(){this.vereine=[],this.vereinDataProvider.findAll().then(e=>{this.vereine=e.payload.sort(),this.loadingVereine=!1,this.selectedVereinsId=this.hasID?this.providedID:e.payload[0].id,this.changeSelectedVerein(),this.onSelect(this.selectedVereine)}).catch(e=>{this.vereine=e.payload})}loadTableRows(){this.loadingTable=!0,this.mannschaftsDataProvider.findAllByVereinsId(this.selectedVereinsId).then(e=>this.handleFindMannschaftenSuccess(e)).catch(e=>this.handleFindMannschaftenFailure(e))}handleFindMannschaftenFailure(e){this.rows=[],this.loadingTable=!1}handleFindMannschaftenSuccess(e){let t;for(this.rows=[],this.remainingMannschaftsRequests=e.payload.length,e.payload.length<=0&&(this.loadingTable=!1),t=0;t<e.payload.length;t++){const n=e.payload[t].name+". Mannschaft";this.wettkampfDataProvider.findAllWettkaempfeByMannschaftsId(e.payload[t].id).then(e=>this.handleFindWettkaempfeSuccess(e,n)).catch(e=>this.handleFindWettkaempfeFailure(e))}}handleFindWettkaempfeFailure(e){this.rows=[],this.loadingTable=!1}handleFindWettkaempfeSuccess(e,t){console.log("success"),this.remainingRequests=e.payload.length,this.remainingMannschaftsRequests-=1,e.payload.length<=0&&(this.loadingTable=!1);for(const n of e.payload){const e=n.wettkampfTag+". Wettkampftag",i=n.wettkampfOrtsname;this.veranstaltungsDataProvider.findById(n.wettkampfVeranstaltungsId).then(n=>this.handleFindVeranstaltungSuccess(n,t,e,i)).catch(e=>this.handleFindVeranstaltungFailure(e))}if(0===e.payload.length){const e=new m("","",t,"");this.tableContent.push(e)}this.remainingMannschaftsRequests<=0&&(this.rows=Object(u.toTableRows)(this.tableContent))}handleFindVeranstaltungFailure(e){this.rows=[],this.loadingTable=!1}handleFindVeranstaltungSuccess(e,t,n,i){console.log("Content:"+e.payload.name+n+t+i);const a=new m(e.payload.name,n,t,i);this.tableContent.push(a),this.remainingRequests-=1,this.remainingRequests<=0&&(this.rows=Object(u.toTableRows)(this.tableContent),this.tableContent=[],this.loadingTable=!1)}}return e.\u0275fac=function(t){return new(t||e)(y.Lb(s.c),y.Lb(s.a),y.Lb(E.c),y.Lb(f.a),y.Lb(b.a),y.Lb(p.a),y.Lb(g.a))},e.\u0275cmp=y.Fb({type:e,selectors:[["bla-vereine"]],features:[y.wb],decls:15,vars:16,consts:[[3,"config"],["href","https://wiki.bsapp.de/doku.php?id=liga:vereine","target","_blank"],[1,"subtitle"],[1,"row"],[2,"display","inline"],["selectionListHeight","15em",2,"width","50%","flex-grow","0",3,"selectedItemIds","items","loading","multipleSelections","placeholderTranslationKey","optionFieldSelector","onSelect"],[3,"config","loading","rows","onColumnEntry","onRowEntry","onMapEntry"]],template:function(e,t){1&e&&(y.Qb(0,"bla-navigation-dialog",0),y.Mb(1,"bla-hilfe-button",1),y.Qb(2,"p",2),y.Bc(3),y.ac(4,"translate"),y.Pb(),y.Qb(5,"div",3),y.Qb(6,"div"),y.Qb(7,"h2",4),y.Bc(8,"Gew\xe4hlter Verein: "),y.Pb(),y.Qb(9,"h3",4),y.Bc(10),y.Pb(),y.Pb(),y.Qb(11,"bla-col-layout"),y.Qb(12,"bla-quicksearch-list",5),y.Xb("onSelect",(function(e){return t.onSelect(e)})),y.Pb(),y.Pb(),y.Pb(),y.Qb(13,"div",3),y.Qb(14,"bla-data-table",6),y.Xb("onColumnEntry",(function(e){return t.getSelectedColumn(e)}))("onRowEntry",(function(e){return t.getSelectedRow(e)}))("onMapEntry",(function(e){return t.onMap(e)})),y.Pb(),y.Pb(),y.Pb()),2&e&&(y.fc("config",t.config),y.zb(3),y.Cc(y.bc(4,12,"VEREINE.VEREINE.DESCRIPTION")),y.zb(7),y.Cc(t.getSelectedDTO()),y.zb(2),y.fc("selectedItemIds",y.kc(14,P,t.selectedVereinsId))("items",t.vereine)("loading",t.loadingVereine)("multipleSelections",!t.multipleSelections)("placeholderTranslationKey",t.PLACEHOLDER_VAR)("optionFieldSelector","name"),y.zb(2),y.fc("config",t.config_table)("loading",t.loadingTable)("rows",t.rows))},directives:[w.a,V.a,T.a,I.a,S.a],pipes:[D.d],styles:[".row[_ngcontent-%COMP%]{margin:20px;display:flex;flex-direction:column}"]}),e})();const C=[{path:"",pathMatch:"full",component:R},{path:"/:id",pathMatch:"full",component:R}];let k=(()=>{class e{}return e.\u0275mod=y.Jb({type:e}),e.\u0275inj=y.Ib({factory:function(t){return new(t||e)},imports:[[i.c,s.g.forChild(C),l.a,a.k]]}),e})()}}]);